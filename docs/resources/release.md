---
page_title: "tanka_release Resource - tanka"
subcategory: ""
description: |-
  Tanka release
---

# tanka_release (Resource)

Tanka release

A release is an instance of a Tanka Package running in a Kubernetes cluster.

The `tanka_release` resource describes the desired status of the Tanka Package.

Configuration is passed in either `config` or `config_override`.

This structure is born out of a need to be able to set default configuration at both the jsonnet and terraform level along with the option to let environments override config in the ci/cd pipeline.

Both config vars, together with `api_server` and `namespace` are passed to tanka as tla-code vars.

This structure assumes that the tanka package is configured with [inline environments](https://tanka.dev/inline-environments) in order to dynamically set the `api_server` and `namespace`. A minimal setup for `main.jsonnet` using this provider could look like this:

```jsonnet
function(apiServer, namespace, config={}, config_override={}) {

  local default = {},
  local override = std.mergePatch(config, config_override),
  local conf = std.mergePatch(default, override),

  apiVersion: 'tanka.dev/v1alpha1',
  kind: 'Environment',
  metadata: {
    name: 'default',
  },
  spec: {
    namespace: namespace,
    apiServer: apiServer,
    injectLabels: true,
  },

  data: {
    // your kubernetes resource definitions here
  },
}
```

Using the std.mergePatch() function from the jsonnet standard library ensures that nested json objects are deep merged and not overwritten if identical keys are found.

Note the camelCase in `apiServer` in the jsonnet context.

Both `config` and `config_override` are json objects given either directly in the resource definition by parsing through `jsonencode()` or by loading a file from either a local (by prefixing with `file://`) or remote (by prefixing with `http://` or `https://`) source. The remote sources must be publicly accessible, at this time there is no mechanism for providing authentication credentials to the remote server.

## Example Usage

```terraform
resource "tanka_release" "minimal" {}

resource "tanka_release" "config_override_inline " {
  config = jsonencode({
    key_1 : "value_1"
    key_2 : "value_2"
  })
  config_override = jsonencode({
    key_1 : "overridden_value_1",
  })
}

resource "tanka_release" "config_override_external_file " {
  config = jsonencode({
    key_1 : "value_1"
    key_2 : "value_2"
  })
  config_override = "file://tanka_config_override.json"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `config` (String) Configuration object in arbitrary JSON format. The data can be provided inline with jsonencode() or given as a file. Local file paths are prefixed with `file://` and remote sources with the correct protocol `http://` or `https://`. Remote sources must be publicly available. Defaults to the empty object.
- `config_override` (String) Configuration override object in arbitrary JSON format. The data can be provided inline with jsonencode() or given as a file. Local file paths are prefixed with `file://` and remote sources with the correct protocol `http://` or `https://`. Remote sources must be publicly available. Defaults to the empty object.
- `namespace` (String) The Kubernetes namespace to install the release into. Defaults to `default`.
- `source_path` (String) The location of the Tanka main file. Defaults to `tanka/environments/default`.
- `version` (String) A version number for the Tanka package. Examples could be a git commit SHA, or a random value to force update on every run. This value is not passed to the tanka application, if version information needs to be available to tanka it should be set as a subkey in one of the config objects.

### Read-Only

- `id` (String) The ID of the resource. Consists of the cluster endpoint suffixed with a six letter random string (underscore separated).
- `last_updated` (String) Timestamp updated on every apply operation.
